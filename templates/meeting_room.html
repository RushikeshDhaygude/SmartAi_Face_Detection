<!DOCTYPE html>
<html>
  <head>
    <title>Two Components, Left and Right</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='meeting_room.css') }}">
    <script>
      var video;
    navigator.mediaDevices.getUserMedia({ video: true })
      .then(function(stream) {
        video = document.querySelector('video');
        video.srcObject = stream;
        video.onloadedmetadata = function(e) {
          video.play();
        };
      })
      .catch(function(err) {
        console.log(err.name + ": " + err.message);
      });
      

    function captureFrame() {
      // alert("Hello Working");
      var canvas = document.createElement('canvas');
      canvas.width = video.videoWidth;
      canvas.height = video.videoHeight;
      var ctx = canvas.getContext('2d');
      ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
      
      return canvas.toDataURL();
    }

    function sendFrames() {
      
      var frames = [];
      for (var i = 0; i < 10; i++) { // Capture 10 frames
        frames.push(captureFrame());
      }
      console.log(frames)
      // Send the frames to the Flask endpoint
     
      fetch('/video_frames', {
        method: 'POST',
        body: frames
      }).then(function (response) {
        console.log("Hello");
        // Handle the response from the server
      });
    }
    </script>
  </head>
  <body>
    <div class="container">
      <div class="left-component">
        <!-- <a href="{{ url_for('run_eye_tracking') }}">Function 1</a> -->
        <h2>Student Webcam</h2>
        <video></video>
        <button onclick="sendFrames()">Send Frames</button>

      </div>
      <div class="right-component">
        <h2>HeatMap</h2>

      </div>
    </div>
  </body>
</html>
